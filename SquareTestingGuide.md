# Square Checkout Testing Guide

This guide provides information on how to test the Square Checkout integration in the sandbox environment.

## Square Sandbox Test Cards

When testing payments in the Square Checkout sandbox environment, you can use the following test card numbers:

### Card Numbers

| Card Type | Card Number | CVV | Expiration Date | Postal Code |
|-----------|-------------|-----|----------------|-------------|
| Visa | 4111111111111111 | Any 3 digits | Any future date | Any 5 digits |
| Mastercard | 5105105105105100 | Any 3 digits | Any future date | Any 5 digits |
| American Express | 378282246310005 | Any 4 digits | Any future date | Any 5 digits |
| Discover | 6011111111111117 | Any 3 digits | Any future date | Any 5 digits |

### Test Scenarios

#### Successful Payment
- Use any of the test card numbers above with valid expiration date and CVV
- The transaction will be approved

#### Declined Payment
- Use card number: 4000 0000 0000 0002
- The transaction will be declined

#### Card Verification Failure
- Use card number: 4000 0000 0000 0101
- The transaction will fail with a card verification error

## Testing Process

1. Navigate to the checkout page in the SimStudio application
2. Fill in the required information (if you're not logged in)
3. Click the "Proceed to Checkout" button
4. You will be redirected to Square's hosted checkout page
5. On the Square checkout page, enter one of the test card numbers from above
6. Enter any future expiration date (e.g., 12/25)
7. Enter any 3 digits for CVV (4 digits for American Express)
8. Enter any 5 digits for postal code
9. Complete the checkout process
10. You will be redirected back to the SimStudio application's success page

## Testing User Flows

### Logged-in User Flow
1. Log in to your SimStudio account
2. Navigate to the packages or booking page
3. Select the desired package/hours
4. Proceed to checkout
5. Click "Proceed to Checkout" to be redirected to Square's hosted checkout page
6. Complete the payment using test card details
7. You will be redirected back to the success page
8. Verify that credits have been added to your account

### Guest User Flow
1. Navigate to the packages or booking page without logging in
2. Select the desired package/hours
3. Proceed to checkout
4. Enter your name and email in the checkout form
5. Click "Proceed to Checkout" to be redirected to Square's hosted checkout page
6. Complete the payment using test card details
7. You will be redirected back to the success page
8. Verify that an account has been created for you and credits have been added

## Important Notes

- These test cards only work in the Square sandbox environment
- No real charges will be made when using these test cards
- The Square sandbox environment is completely separate from the production environment
- All transactions in the sandbox environment are simulated
- The Square Checkout page is hosted by Square, not by SimStudio
- After payment, users are redirected back to SimStudio via the configured redirect URL

## Troubleshooting

If you encounter any issues with the checkout process:

1. Make sure you're using a supported browser (Chrome, Firefox, Safari, Edge)
2. Check the browser console for any JavaScript errors
3. Verify that the Square sandbox credentials are correctly configured in the .env.local file
4. Ensure that the SQUARE_ENVIRONMENT is set to 'sandbox' in the .env.local file
5. Verify that the NEXT_PUBLIC_BASE_URL is correctly set to your application's URL
6. Check that the redirect URL is properly configured in the Square Developer Dashboard

## Viewing Test Transactions

You can view all test transactions in the Square Developer Dashboard:

1. Log in to the [Square Developer Dashboard](https://developer.squareup.com/apps)
2. Select your application
3. Click on "Sandbox Test Account"
4. Navigate to "Transactions" to see all test payments
5. You can also view the checkout links created in the "Online Checkout" section

## Testing Reference IDs and Metadata

When testing the integration, you may want to verify that reference IDs and metadata are correctly passed between SimStudio and Square:

1. Complete a test transaction
2. In the Square Developer Dashboard, navigate to the transaction details
3. Check that the reference ID matches the one generated by SimStudio
4. Verify that the metadata contains the correct user information

For more information, refer to the [Square Testing documentation](https://developer.squareup.com/docs/testing/test-values) and [Square Checkout API documentation](https://developer.squareup.com/docs/checkout-api-overview).
